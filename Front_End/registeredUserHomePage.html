<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Easy Car Rental</title>
    <meta content="width=device-width initial-scale=1" name="viewport">
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@1,700&display=swap" rel="stylesheet">
    <style>
        * {
            scroll-behavior: smooth;
            transition: all 1s;
        }

        .carousel {
            width: 440px;
            height: 270px;
        }
    </style>
</head>
<body>
<div class="container-fluid bg-white">

    <!--Navbar-->
    <nav class="navbar navbar-expand-lg bg-body-tertiary fixed-top shadow-lg bg-white">
        <div class="container-fluid row">
            <a class="navbar-brand col-7 ml-5" href="index.html">
                <img alt="Logo" class="d-inline-block align-text-top" height="50"
                     src="assets/img/Easy Car Rental Logo.jpg"
                     width="100">
            </a>
            <button aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"
                    class="navbar-toggler"
                    data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse ml-5 mr-0 pr-0 flex-grow-0" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item ml-3 mr-3">
                        <a aria-current="page" class="nav-link active" href="#home" id="homeNav">HOME</a>
                    </li>
                    <li class="nav-item ml-3 mr-3">
                        <a class="nav-link" href="#about_us" id="aboutNav">ABOUT US</a>
                    </li>
                    <li class="nav-item ml-3 mr-3">
                        <a class="nav-link" href="#contact_us" id="contactNav">CONTACT</a>
                    </li>
                    <li class="nav-item ml-3 mr-3">
                        <a class="nav-link" href="#" id="dashboardNav">DASHBOARD</a>
                    </li>
                    <li class="nav-item ml-3 mr-3">
                        <a class="nav-link" href="#" id="signOutNav">SIGN OUT</a>
                    </li>
                </ul>
            </div>
            <!--                              <button type="button" class="btn btn-warning" href="index.html">Sign in</button>-->
        </div>
    </nav>

    <!--Home-->
    <div class="row position-relative" id="home">
        <img alt="img"
             class="img-fluid background"
             src="assets/img/doi-luang-chiang-dao-mountains-sunrise-chiang-mai-thailand.jpg"
             style="height: 75vh; width: 100vw;">

        <!--Home Description-->
        <div class="position-absolute align-self-center"
             style="font-family: 'Josefin Sans', sans-serif; left: 5%; color: white; width: 50%;">
            <p class="h1" style="font-size: 105px">Car Rental</p>
            <p class="h1" style="font-size: 105px">in Sri Lanka</p>
            <p class="h1" style="font-size: 17px">With over 5 years of experience in the industry, we strive to offer
                the highest levels of customer service and a highly personalised service to all our customers who are on
                the lookout for Sri Lanka car rental opportunities. With one of the largest and most modern and varied
                fleets in Sri Lanka, Easy is known for its high levels of customer service quality and satisfaction.</p>
        </div>
    </div>

    <!--Car Details Cards-->
    <div class="container bg-white">
        <div class="container">
            <p class="h1 mt-5 mb-5" id="car_details"
               style="font-family: 'Josefin Sans', sans-serif; font-size: 85px; font-style: italic">What Are You Looking
                For</p>
            <h1 class="h1 mb-3" style="font-family: 'Josefin Sans', sans-serif;">Luxury Cars</h1>
            <div class="row row-cols-1 row-cols-md-3 g-4" id="luxuryCarsContainer"></div>
            <h1 class="h1 mb-3 mt-3" style="font-family: 'Josefin Sans', sans-serif;">Premium Cars</h1>
            <div class="row row-cols-1 row-cols-md-3 g-4" id="premiumCarsContainer"></div>
            <h1 class="h1 mb-3 mt-3" style="font-family: 'Josefin Sans', sans-serif;">General Cars</h1>
            <div class="row row-cols-1 row-cols-md-3 g-4" id="generalCarsContainer"></div>
        </div>
    </div>

    <!--About Us-->
    <div class="container bg-white">
        <p class="h1 mt-5 mb-4" id="about_us"
           style="font-family: 'Josefin Sans', sans-serif; font-size: 85px; font-style: italic">
            WHO WE ARE</p>
        <p> With over 05 years of experience in the industry, we strive to offer the highest levels of customer service
            and a highly personalised service to all our customers.
        </p>
        <p>With one of the largest and most modern and varied fleets in Sri Lanka, our service is backed by a networked
            front office, fully-fledged mechanical servicing and valet servicing onsite making us one of the preferred
            providers of Sri Lanka car rentals in the island.</p>

        <!--        <img src="assets/img/Easy Car Rental Logo.jpg" alt="Logo" class="d-inline-block align-text-top">-->
    </div>

    <!--Contact Us-->
    <div class="container bg-white mb-5">
        <p class="h1 mt-5 mb-4" id="contact_us"
           style="font-family: 'Josefin Sans', sans-serif; font-size: 85px; font-style: italic">Contact</p>
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <form>
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input class="form-control" id="name" type="text"/>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input class="form-control" id="email" type="email"/>
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea class="form-control" id="message" rows="3"></textarea>
                        </div>
                        <button class="btn btn-warning" type="submit">Submit</button>
                    </form>
                </div>
                <div class="col-md-6">
                    <iframe
                            allowfullscreen=""
                            class="h-100 w-100" frameborder="0" loading="lazy" marginheight="0"
                            marginwidth="0" scrolling="no"
                            src="https://maps.google.com/maps?q=easy car rental&t=&z=10&ie=UTF8&iwloc=&output=embed"
                            style="border:0;">

                    </iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="row">
                        <h1 class="modal-title fs-5 col-12" id="carNameOnModal"
                            style="font-family: 'Josefin Sans', sans-serif; font-size: 40px; font-style: italic">Car
                            Name</h1>
                        <h6 class="fs-5 col-12" id="carTypeOnModal" style="font-style: italic">Car Type</h6>
                    </div>

                </div>
                <div class="modal-body">
                    <div class="row">
                        <!--carousel-->
                        <div class="col-12">
                            <div class="carousel slide" data-ride="carousel" id="carDetailsModal">
                                <div class="carousel-inner">
                                    <div class="carousel-item active">
                                        <img alt="..." class="d-block w-100"
                                             id="carDetailsModalImg1" src="assets/img/car/BMW_i8-removebg-preview.png">
                                    </div>
                                    <div class="carousel-item">
                                        <img alt="..." class="d-block w-100"
                                             id="carDetailsModalImg2"
                                             src="assets/img/car/Mercedes-removebg-preview.png">
                                    </div>
                                    <div class="carousel-item">
                                        <img alt="..."
                                             class="d-block w-100"
                                             id="carDetailsModalImg3"
                                             src="assets/img/car/Perodua_Bezza_Prime_Sedan-removebg-preview.png">
                                    </div>
                                    <div class="carousel-item">
                                        <img alt="..."
                                             class="d-block w-100"
                                             id="carDetailsModalImg4"
                                             src="assets/img/car/Perodua_Bezza_Prime_Sedan-removebg-preview.png">
                                    </div>
                                </div>
                                <button class="carousel-control-prev btn" data-slide="prev"
                                        data-target="#carDetailsModal"
                                        style="box-shadow: transparent" type="button">
                                    <span aria-hidden="true" class="carousel-control-prev-icon"></span>
                                    <span class="visually-hidden"></span>
                                </button>
                                <button class="carousel-control-next btn" data-slide="next"
                                        data-target="#carDetailsModal"
                                        type="button">
                                    <span aria-hidden="true" class="carousel-control-next-icon"></span>
                                    <span class="visually-hidden"></span>
                                </button>
                            </div>
                        </div>
                        <!--Vehicle Details-->
                        <div class="row mt-4 ml-2" style="font-size: 15px;">
                            <div class="col-12 row">
                                <div class="col-2">
                                    <img alt="icon" src="assets/icon/team-28-256.png" style="height: 25px;width: 25px;">
                                </div>
                                <p class="h7 col-3" id="passengerOnModalDetails">00 Passen</p>
                                <p class="h7 col-4" style="font-family: 'Josefin Sans', sans-serif;">Daily Rates :</p>
                                <p class="h7 col-3" id="dailyOnModalDetails">Rs 1500/-</p>
                            </div>
                            <div class="col-12 row">
                                <div class="col-2">
                                    <img alt="icon" src="assets/icon/gear.png" style="height: 25px;width: 25px;">
                                </div>
                                <p class="h7 col-3" id="transmissionOnModalDetails">Auto</p>
                                <p class="h7 col-4" style="font-family: 'Josefin Sans', sans-serif;">Monthly Rates :</p>
                                <p class="h7 col-3" id="monthlyOnModalDetails">Rs 10500/-</p>
                            </div>
                            <div class="col-12 row">
                                <div class="col-2">
                                    <img alt="icon" src="assets/icon/fuel type.png" style="height: 25px;width: 25px;">
                                </div>
                                <p class="h7 col-3" id="fuelOnModalDetails">Diesol</p>
                                <p class="h7 col-4" style="font-family: 'Josefin Sans', sans-serif;">Extra KM :</p>
                                <p class="h7 col-3" id="extraKmOnModalDetails">Rs 100/-</p>
                            </div>
                            <div class="col-12 row">
                                <div class="col-2">
                                    <img alt="icon" src="assets/icon/painting.png" style="height: 30px;width: 30px;">
                                </div>
                                <p class="h7 col-3" id="colorOnModalDetails">Color</p>
                            </div>
                            <div class="col-11">
                                <div class="col-12 row ml-2" style="background: #bbd9fa; border-radius: 5px;">
                                    <div class="col-6 mt-3">
                                        <p class="h7 col" style="font-family: 'Josefin Sans', sans-serif;">Pick Up Date
                                            :</p>
                                        <input class="col" id="pickUpDate" name="Pick Up Date" type="date">
                                    </div>
                                    <div class="col-6 mt-3">
                                        <p class="h7 col" style="font-family: 'Josefin Sans', sans-serif;">Return Date
                                            :</p>
                                        <input class="col" id="returnDate" name="Return Date" type="date">
                                    </div>
                                    <div class="col-12 mt-4 row">
                                        <div class="form-check ml-3">
                                            <input checked class="form-check-input" id="exampleRadios1"
                                                   name="exampleRadios" type="radio" value="option1">
                                            <label class="form-check-label" for="exampleRadios1">
                                                Self Drive
                                            </label>
                                        </div>
                                        <div class="form-check ml-2">
                                            <input class="form-check-input" id="exampleRadios2" name="exampleRadios"
                                                   type="radio" value="option2">
                                            <label class="form-check-label" for="exampleRadios2">
                                                With Driver
                                            </label>
                                        </div>
                                    </div>
                                    <p class="col-12" style="font-size: x-small;">Driver Charge Rs 1000/- per Day
                                        Additionally</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-dismiss="modal" type="button">Close</button>
                    <button class="btn" data-dismiss="modal" data-target="#exampleModalToggle2" data-toggle="modal"
                            id="calculateReserveBtn" style="background: #FB6011; border-color: #FB6011; color: white"
                            type="button">Reserve
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal 2 -->
    <div aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" class="modal fade" id="exampleModalToggle2"
         tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5 col-12"
                        style="font-family: 'Josefin Sans', sans-serif; font-size: 40px; font-style: italic">Reservation
                        Details</h1>
                </div>
                <div class="modal-body position-relative">
                    <div class="row">
                        <div class="col-12 row">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Car :</p>
                            <p class="h7" id="carNameModal2">Car Name</p>
                        </div>
                        <div class="col-12 row">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Register Number :</p>
                            <p class="h7" id="carRegisterNumModal2">C000</p>
                        </div>
                        <div class="col-12 row">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Total :</p>
                            <p class="h7" id="totalModal2">Rs 0000/-</p>
                        </div>
                        <div class="col-12 row">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Pick Up Date :</p>
                            <p class="h7" id="todayModal2">12/02/2023</p>
                        </div>
                        <div class="col-12 row">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Return Date :</p>
                            <p class="h7" id="returnDateModal2">15/02/2023</p>
                        </div>
                        <div class="col-12 row mt-2">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Customer Name :</p>
                            <p class="h7" id="customerModal2">Customer Name</p>
                        </div>
                        <div class="col-12 row">
                            <p class="h7 col-6" style="font-family: 'Josefin Sans', sans-serif;">Customer Email :</p>
                            <p class="h7" id="customerEmailModal2">example@gmail.com</p>
                        </div>

                        <div class="col-11 ml-2" style="background: #bbd9fa; border-radius: 5px;">
                            <div class="row mt-2 mb-2">
                                <p class="h8 col-12 ml-3" style="color: red">Make a payment before reservation..!</p>
                                <p class="h6 col-12 ml-3">Bank Details</p>
                                <div class="col-12 mt-2">
                                    <div class="carousel slide" id="bankDetailsCarousel" style="height: 100px">
                                        <div class="carousel-inner">
                                            <div class="carousel-item active">
                                                <div>
                                                    <p class="h6 col-12">Bank Name : Commercial Bank</p>
                                                    <p class="h6 col-12">Account Name : Easy Car Rental</p>
                                                    <p class="h6 col-12">Account Number : 8007231654</p>
                                                </div>
                                            </div>
                                            <div class="carousel-item">
                                                <div>
                                                    <p class="h6 col-12">Bank Name : Peoples Bank</p>
                                                    <p class="h6 col-12">Account Name : Easy Car Rental</p>
                                                    <p class="h6 col-12">Account Number : 2001387454</p>
                                                </div>
                                            </div>
                                            <div class="carousel-item">
                                                <div>
                                                    <p class="h6 col-12">Bank Name : Bank of Ceylon</p>
                                                    <p class="h6 col-12">Account Name : Easy Car Rental</p>
                                                    <p class="h6 col-12">Account Number : 204567004</p>
                                                </div>
                                            </div>
                                            <button class="carousel-control-prev btn" data-slide="prev"
                                                    data-target="#bankDetailsCarousel"
                                                    hidden
                                                    style="box-shadow: transparent" type="button">
                                                <span aria-hidden="true" class="carousel-control-prev-icon"></span>
                                                <span class="visually-hidden"></span>
                                            </button>
                                            <button class="carousel-control-next btn" data-slide="next"
                                                    data-target="#bankDetailsCarousel"
                                                    type="button">
                                                <span aria-hidden="true" class="carousel-control-next-icon"></span>
                                                <span class="visually-hidden"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <p class="col-12 ml-3" style="color: #95999c; font-size: small">After payment , Click
                                    the Reserve Button Below.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-dismiss="modal" data-target="#exampleModal"
                            data-toggle="modal"
                            type="button">Go Back
                    </button>
                    <button class="btn" data-dismiss="modal" id="reserveBtn"
                            style="background: #FB6011; border-color: #FB6011; color: white"
                            type="button">Reserve
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Dashboard Modal -->
    <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade" data-backdrop="static"
         data-keyboard="false"
         id="dashboardModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content" style="width: 60vw;">
                <div class="modal-header">
                    <h1 class="modal-title fs-5"
                        style="font-family: 'Josefin Sans', sans-serif; font-size: 40px; font-style: italic">User
                        Dashboard</h1>
                </div>
                <div class="modal-body">
                    <!--  Customer Booking Table-->
                    <div class="table-responsive mb-3" style="height: 30vh;max-height: 60vh; overflow-y: scroll;">
                        <table class="table shadow table-hover">
                            <thead class="thead-dark">
                            <tr class="table-primary">
                                <th scope="col">Booking ID</th>
                                <th scope="col">Car</th>
                                <th scope="col">Pick Up Date</th>
                                <th scope="col">Return Date</th>
                                <th scope="col">Driver</th>
                                <th scope="col">Total</th>
                                <th scope="col">Status</th>
                                <th scope="col">Options</th>
                            </tr>
                            </thead>
                            <tbody id="bookingTbl">
                            </tbody>
                        </table>
                    </div>
                    <h1 class="modal-title fs-5"
                        style="font-family: 'Josefin Sans', sans-serif; font-size: 30px; font-style: italic">
                        Setting</h1>
                    <div class="row mt-2 container">
                        <div class="col-md-6">
                            <label class="form-label" for="userName">Name</label>
                            <input class="form-control" id="userName" placeholder="User Name" type="text">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label" for="userEmail">Email</label>
                            <input class="form-control" disabled id="userEmail" placeholder="example@gmail.com"
                                   type="email">
                        </div>
                        <div class="col-12 mt-3">
                            <label class="form-label" for="userAddress">Address</label>
                            <input class="form-control" id="userAddress" placeholder="Colombo 07" type="text">
                        </div>
                        <div class="col-md-6 mt-3">
                            <label class="form-label" for="userNICorLicenceNo">NIC or Licence Number</label>
                            <input class="form-control" disabled id="userNICorLicenceNo" placeholder="2034725934V"
                                   type="text">
                        </div>
                        <div class="col-md-6 mt-3">
                            <label class="form-label" for="userContact">Contact</label>
                            <input class="form-control" id="userContact" placeholder="0718539064" type="text">
                        </div>

                        <!--Collapse Control-->
                        <div class="col-12 mt-2 row">
                            <p class="col-2 pr-0 mt-3">
                                <a aria-controls="collapseExample" aria-expanded="false" class="text"
                                   data-toggle="collapse"
                                   href="#collapseExample" role="button">
                                    Change Password
                                </a>
                            </p>
                            <p class="col-2 pl-0 mt-3">
                                <a aria-controls="collapseExample2" aria-expanded="true" class="text text-danger"
                                   data-toggle="collapse"
                                   href="#collapseExample2" role="button">
                                    Delete Account
                                </a>
                            </p>
                        </div>
                        <!--Delete Account Collapse-->
                        <div class="collapse col-12" id="collapseExample2">
                            <div class="card card-body">
                                <div class="row">
                                    <h2 class="col-md-12 text-danger">Warning</h2>
                                    <h6 class="col-md-12" style="color:#4b4b4b;">Once you delete your account, there's
                                        no getting it back.
                                        Make sure you want to do this.</h6>
                                    <input class="form-control col-md-4 mt-2 ml-3" id="currentPwdForDeleteAccount"
                                           placeholder="Current Password"
                                           type="text">
                                    <button class="btn btn-danger col-md-2 ml-2 mt-2" id="deleteAccBtn">Delete Account
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!--Change Password Collapse-->
                        <div class="collapse col-12" id="collapseExample">
                            <div class="card card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <input class="form-control" id="currentPwd" placeholder="Current Password"
                                               type="text">
                                    </div>
                                    <div class="col-md-3">
                                        <input class="form-control" id="newPwd" placeholder="New Password" type="text">
                                    </div>
                                    <div class="col-md-3">
                                        <input class="form-control" id="confirmNewPwd"
                                               placeholder="Confirm New Password" type="text">
                                    </div>
                                    <button class="btn btn-danger col-md-2" id="changePwdBtn">Change Password</button>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 ml-0 mt-2 row">
                            <div class="col-2 btn-group pl-0">
                                <button class="btn btn-warning" id="btnUpdateUser" type="button">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-dismiss="modal" type="button">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Return Car Modal -->
    <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade" data-backdrop="static"
         data-keyboard="false"
         id="returnCardModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5"
                        style="font-family: 'Josefin Sans', sans-serif; font-size: 40px; font-style: italic">Return</h1>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-auto">
                            <label for="extraKmInputField">Extra Km</label>
                            <input class="form-control" id="extraKmInputField" placeholder="00"
                                   type="text">
                            <label class="small" style="color: #b3b7bb">Enter the extra km you went</label>
                        </div>
                        <div class="col-auto mt-2">
                            <input class="form-check-input ml-1" id="damageCheckBox" type="checkbox" value="">
                            <label class="form-check-label ml-4" for="damageCheckBox">
                                If your vehicle have damage select this check box
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-dismiss="modal" data-target="#dashboardModal"
                            data-toggle="modal"
                            type="button">Go Back
                    </button>
                    <button class="btn btn-success" data-dismiss="modal" id="returnCarBtn"
                            style="color: white"
                            type="button">Return
                    </button>
                </div>
            </div>
        </div>
    </div>


</div>

<footer>
    <div class="container-fluid" style="background: #1C201F">
        <div class="row">
            <img alt="Logo" class="" src="assets/img/Easy Car Rental Logo.jpg">
        </div>
        <div class="row" style="width: 100%; height: 10%">
            <a href="https://www.facebook.com/kavindu.thiwanka.925" target="_blank"><i
                    class="fab fa-facebook-f"></i></a>
            <a href="https://www.instagram.com/kavindu.thiwank0" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://www.linkedin.com/in/kavindu-thiwanka-762385239" target="_blank"><i
                    class="fab fa-linkedin"></i></a>
            <a href="https://github.com/kavindu1thiwanka" target="_blank"><i class="fab fa-github"></i></a>
        </div>
    </div>
</footer>
<script src="assets/js/jquery-3.6.1.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script>

    let baseURL = "http://localhost:8080/easy/";

    let car;
    let bookingId;
    let date = new Date().toJSON().slice(0, 10);

    loadAllLuxuryCars();
    loadAllPremiumCars();
    loadAllGeneralCars();
    loadUserData();

    $("#dashboardNav").click(function () {
        loadUserData();
        $('#dashboardModal').modal('show');
    });

    //Customer CRUD

    $("#btnUpdateUser").click(function () {

        let userEmail = $("#userEmail").val();
        let userName = $("#userName").val();
        let userAddress = $("#userAddress").val();
        let userNICorLicenceNo = $("#userNICorLicenceNo").val();
        let userContact = $("#userContact").val();

        var userObj = {
            userEmail: userEmail,
            userName: userName,
            userAddress: userAddress,
            userNICorLicenceNo: userNICorLicenceNo,
            userContact: userContact
        }

        $.ajax({
            url: baseURL + 'user',
            method: 'put',
            contentType: "application/json",
            data: JSON.stringify(userObj),
            dataType: "json",
            success: function (res) {
                alert(res.message);
                loadUserData();
            },
            error: function (error) {
                let cause = JSON.parse(error.responseText).message;
                alert(cause);
            }

        });
    });

    $("#changePwdBtn").click(function () {

        let userEmail = $("#userEmail").val();
        let currentPwd = $("#currentPwd").val();
        let newPwd = $("#newPwd").val();
        let confirmNewPwd = $("#confirmNewPwd").val();
        let userId = $("#userNICorLicenceNo").val();
        let role = "User";

        var allUserObj = {
            userId: userId,
            userEmail: userEmail,
            userPwd: newPwd,
            role: role
        }

        $.ajax({
            url: baseURL + 'home/login',
            dataType: "json",
            success: function (res) {
                for (let u of res.data) {
                    if (u.userEmail === userEmail) {
                        if (u.userPwd === currentPwd) {
                            if (newPwd === confirmNewPwd) {
                                $.ajax({
                                    url: baseURL + 'user/all',
                                    method: 'put',
                                    contentType: "application/json",
                                    data: JSON.stringify(allUserObj),
                                    dataType: "json",
                                    success: function (res) {
                                        alert(res.message);
                                        loadUserData();
                                    },
                                    error: function (error) {
                                        let cause = JSON.parse(error.responseText).message;
                                        alert(cause);
                                    }

                                });
                            } else {
                                alert("Password Confirmation Failed..!");
                            }
                        } else {
                            alert("Current Password Incorrect..!")
                        }
                        break;
                    } else {

                    }
                }
            },
            error: function (error) {
                let cause = JSON.parse(error.responseText).message;
                alert(cause);
            }

        });
    });

    $("#deleteAccBtn").click(function () {
        let userEmail = $("#userEmail").val();
        let currentPwd = $("#currentPwdForDeleteAccount").val();
        $.ajax({
            url: baseURL + "home/login",
            dataType: "json",
            success: function (resp) {
                for (let us of resp.data) {
                    if (us.userEmail === userEmail) {
                        if (us.userPwd === currentPwd) {
                            $.ajax({
                                url: baseURL + "user?email=" + userEmail + "",
                                method: "delete",
                                dataType: "json",
                                success: function (resp) {
                                    alert(resp.message);
                                    window.location.href = "index.html";
                                },
                                error: function (error) {
                                    alert(JSON.parse(error.responseText).message);
                                }
                            });
                        } else {
                            alert("Current Password Incorrect..!")
                        }
                        break;
                    } else {

                    }
                }
            },
            error: function (err) {
                console.log(err);
            }
        });
    });

    ////////////////////////////////////////////////////////////

    function loadAllLuxuryCars() {
        let content = '';
        $("#tblCustomer").empty();
        $.ajax({
            url: baseURL + "car/luxury",
            dataType: "json",
            success: function (resp) {
                for (let c of resp.data) {
                    content += `
                        <div class="col mb-2">
                                    <div class="card h-100 shadow-sm">
                                        <div class="card-img-top" style="width: 348px; height: 245px">
                                            <img src="${baseURL + c.imgFront}" class="card-img-top" alt="...">
                                        </div>
                                        <div class="card-body">
                                            <h5 class="card-title">${c.carBrand}</h5>
                                            <label>${c.registrationNo}</label>
                                            <div class="row mt-4 card-text">
                                                <div class="row col-7">
                                                    <p class="col-12">Rs ${c.dailyPrice} /-</p>
                                                    <p class="col-12" style="color:#32CD32;">${c.available}</p>
                                                    <label class="carIdOnModal" hidden>${c.registrationNo}</label>
                                                </div>
                                                <button type="button" class="detailsBtn btn btn-primary col-4 align-self-center"
                                                        data-toggle="modal" data-target="#exampleModal"
                                                        style="background: #FB6011; border-color: #FB601100; height: 10%">Details >>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `
                }
                document.querySelector("#luxuryCarsContainer").innerHTML = content;
            }
        });
    }

    function loadAllPremiumCars() {
        let content = '';
        $("#tblCustomer").empty();
        $.ajax({
            url: baseURL + "car/premium",
            dataType: "json",
            success: function (resp) {
                for (let c of resp.data) {
                    content += `
                        <div class="col mb-2">
                                    <div class="card h-100 shadow-sm">
                                        <div class="card-img-top" style="width: 348px; height: 245px">
                                            <img src="${baseURL + c.imgFront}" class="card-img-top" alt="...">
                                        </div>
                                        <div class="card-body">
                                            <h5 class="card-title">${c.carBrand}</h5>
                                            <label>${c.registrationNo}</label>
                                            <div class="row mt-4 card-text">
                                                <div class="row col-7">
                                                    <p class="col-12">Rs ${c.dailyPrice} /-</p>
                                                    <p class="col-12" style="color:#32CD32;">${c.available}</p>
                                                    <label class="carIdOnModal" hidden>${c.registrationNo}</label>
                                                </div>
                                                <button type="button" class="detailsBtn btn btn-primary col-4 align-self-center"
                                                        data-toggle="modal" data-target="#exampleModal"
                                                        style="background: #FB6011; border-color: #FB601100; height: 10%">Details >>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `
                }
                document.querySelector("#premiumCarsContainer").innerHTML = content;
            }
        });
    }

    function loadAllGeneralCars() {
        let content = '';
        $("#tblCustomer").empty();
        $.ajax({
            url: baseURL + "car/general",
            dataType: "json",
            success: function (resp) {
                for (let c of resp.data) {
                    content += `
                        <div class="col mb-2">
                            <div class="card h-100 shadow-sm">
                                <div class="card-img-top" style="width: 348px; height: 245px">
                                    <img src="${baseURL + c.imgFront}" class="card-img-top" alt="General Car Image">
                                </div>
                                <div class="card-body">
                                    <h5 class="card-title">${c.carBrand}</h5>
                                    <label>${c.registrationNo}</label>
                                    <div class="row mt-4 card-text">
                                        <div class="row col-7">
                                            <p class="col-12">Rs ${c.dailyPrice} /-</p>
                                            <p class="col-12" style="color:#32CD32;">${c.available}</p>
                                            <label class="carIdOnModal" hidden>${c.registrationNo}</label>
                                        </div>
                                        <button type="button" class="detailsBtn btn btn-primary col-4 align-self-center"
                                                        data-toggle="modal" data-target="#exampleModal"
                                                        style="background: #FB6011; border-color: #FB601100; height: 10%">Details >>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                            `
                }
                document.querySelector("#generalCarsContainer").innerHTML = content;
            }
        });
    }

    function loadUserData() {
        $("#bookingTbl").empty();
        $.ajax({
            url: baseURL + "user/get",
            dataType: "json",
            success: function (resp) {
                for (let x of resp.data) {
                    $("#userName").val(x.userName);
                    $("#userEmail").val(x.userEmail);
                    $("#userAddress").val(x.userAddress);
                    $("#userNICorLicenceNo").val(x.userNICorLicenceNo);
                    $("#userContact").val(x.userContact);
                    $.ajax({
                        url: baseURL + "booking",
                        dataType: "json",
                        success: function (resp) {
                            for (let b of resp.data) {
                                if (b.bkCusEmail === x.userEmail) {
                                    if (b.bkDriver === "Self Drive"){
                                        if (b.bkStatus === "Active" || b.bkStatus === "Pending") {
                                            var row = '<tr><td>' + b.bkId + '</td><td>' + b.bkCar + '</td><td>' + b.bkDate + '</td><td>' + b.bkReturnDate + '</td><td>' + b.bkDriver + '</td><td>' + b.bkTotal + '</td><td>' + b.bkStatus + '</td><td>' + `<button class="btn btn-success btnReturnVehicle" data-dismiss="modal" data-toggle="modal" data-target="#returnCardModal" type="button">Return</button><button class="btn btn-danger ml-2 cancelReservation" type="button">Cancel</button>` + '</td></tr>';
                                            $("#bookingTbl").append(row);
                                        }
                                        else if (b.bkStatus === "Closed" || b.bkStatus === "Canceled"){
                                            var row2 = '<tr><td>' + b.bkId + '</td><td>' + b.bkCar + '</td><td>' + b.bkDate + '</td><td>' + b.bkReturnDate + '</td><td>' + b.bkDriver + '</td><td>' + b.bkTotal + '</td><td>' + b.bkStatus + '</td><td>' + `<button class="btn btn-success btnReturnVehicle" data-dismiss="modal" data-toggle="modal" data-target="#returnCardModal" type="button" disabled>Return</button><button class="btn btn-danger ml-2 cancelReservation" type="button" disabled>Cancel</button>` + '</td></tr>';
                                            $("#bookingTbl").append(row2);
                                        }
                                    }else{
                                        $.ajax({
                                            url: baseURL + "driver",
                                            dataType: "json",
                                            success: function (resp) {
                                                for (let d of resp.data) {
                                                    if (d.driverEmail === b.bkDriver) {
                                                        if (b.bkStatus === "Active" || b.bkStatus === "Pending") {
                                                            var row = '<tr><td>' + b.bkId + '</td><td>' + b.bkCar + '</td><td>' + b.bkDate + '</td><td>' + b.bkReturnDate + '</td><td>' + d.driverName + '</td><td>' + b.bkTotal + '</td><td>' + b.bkStatus + '</td><td>' + `<button class="btn btn-success btnReturnVehicle" data-dismiss="modal" data-toggle="modal" data-target="#returnCardModal" type="button">Return</button><button class="btn btn-danger ml-2 cancelReservation" type="button">Cancel</button>` + '</td></tr>';
                                                            $("#bookingTbl").append(row);
                                                        }
                                                        else if (b.bkStatus === "Closed" || b.bkStatus === "Canceled"){
                                                            var row2 = '<tr><td>' + b.bkId + '</td><td>' + b.bkCar + '</td><td>' + b.bkDate + '</td><td>' + b.bkReturnDate + '</td><td>' + d.driverName + '</td><td>' + b.bkTotal + '</td><td>' + b.bkStatus + '</td><td>' + `<button class="btn btn-success btnReturnVehicle" data-dismiss="modal" data-toggle="modal" data-target="#returnCardModal" type="button" disabled>Return</button><button class="btn btn-danger ml-2 cancelReservation" type="button" disabled>Cancel</button>` + '</td></tr>';
                                                            $("#bookingTbl").append(row2);
                                                        }
                                                    } else{
                                                        continue;
                                                    }
                                                }
                                            }
                                        });
                                    }
                                } else {
                                    continue;
                                }
                            }
                        }
                    });
                }
            }
        });
    }

    $(document).on('click', '.detailsBtn', function () {
        let id = $(this).closest('div').find('label').text();
        $.ajax({
            url: baseURL + "car?id=" + id + "",
            dataType: "json",
            success: function (resp) {
                car = null;
                car = resp.data;
                for (let x of resp.data) {
                    $("#carNameOnModal").text(x.carBrand);
                    $("#carTypeOnModal").text(x.carType);
                    $("#passengerOnModalDetails").text(x.numberOfPassengers);
                    $("#dailyOnModalDetails").text("Rs " + x.dailyPrice + "/-");
                    $("#transmissionOnModalDetails").text(x.transmissionType);
                    $("#monthlyOnModalDetails").text("Rs " + x.monthlyPrice + "/-");
                    $("#fuelOnModalDetails").text(x.fuelType);
                    $("#extraKmOnModalDetails").text("Rs " + x.priceForExtraKM + "/-");
                    document.getElementById("carDetailsModalImg1").src = baseURL + x.imgFront;
                    document.getElementById("carDetailsModalImg2").src = baseURL + x.imgSide;
                    document.getElementById("carDetailsModalImg3").src = baseURL + x.imgBack;
                    document.getElementById("carDetailsModalImg4").src = baseURL + x.imgInside;
                }
            }
        });
    });

    $(document).on('click', '.btnReturnVehicle', function () {
        bookingId = "";
        bookingId = $(this).closest('tr').children(":eq(0)").text();
    });

    $("#signOutNav").click(function () {
        $.ajax({
            url: baseURL + "user/rem",
            method: "post",
            success: function (resp) {
                window.location.href = "index.html";
            },
            error: function (err) {
                console.log(err);
            }
        });
    });

    $("#calculateReserveBtn").click(function () {
        let total = 0;
        const diffInMs = new Date($('#returnDate').val()) - new Date($('#pickUpDate').val());
        const diffInDays = diffInMs / (1000 * 60 * 60 * 24);
        const remainDays = diffInDays % 30;
        const month = (diffInDays - remainDays) / 30;
        let driverCharge = 0;

        if ($("#exampleRadios2").is(":checked")) {
            driverCharge = 1000 * diffInDays;
        } else if ($("#exampleRadios1").is(":checked")) {
            driverCharge = 0;
        }

        for (let c of car) {
            $("#carNameModal2").text(c.carBrand);
            $("#carRegisterNumModal2").text(c.registrationNo);
            total = (remainDays * c.dailyPrice) + (month * c.monthlyPrice) + driverCharge;
        }
        $("#totalModal2").text(total);
        $("#todayModal2").text($('#pickUpDate').val());
        $("#returnDateModal2").text($('#returnDate').val());
        $.ajax({
            url: baseURL + "user/get",
            dataType: "json",
            success: function (resp) {
                for (let x of resp.data) {
                    $("#customerModal2").text(x.userName);
                    $("#customerEmailModal2").text(x.userEmail);
                }
            }
        });
    });

    $("#reserveBtn").click(function () {
        let dEmail;
        let bookingId;
        let id;

        $.ajax({
            url: baseURL + "booking",
            dataType: "json",
            success: function (res) {
                bookingId = 1;
                bookingId = bookingId + res.data.length;
                $.ajax({
                    url: baseURL + "driver/available",
                    dataType: "json",
                    success: function (resp) {
                        if ($("#exampleRadios2").is(":checked")) {
                            for (let x of resp.data) {
                                dEmail = x.driverEmail;
                                var driverObj = {
                                    driverEmail: x.driverEmail,
                                    driverName: x.driverName,
                                    driverAddress: x.driverAddress,
                                    driverNICorLicenceNo: x.driverNICorLicenceNo,
                                    driverContact: x.driverContact,
                                    available: "Unavailable"
                                }
                                $.ajax({
                                    url: baseURL + "driver",
                                    method: "put",
                                    data: JSON.stringify(driverObj),
                                    contentType: "application/json",
                                    dataType: "json",
                                    success: function (res) {
                                        alert()
                                    },
                                    error: function (err) {
                                        let message = JSON.parse(err.responseText).message;
                                        alert(message);
                                        console.log("Error : " + message)
                                    }
                                });
                                break;
                            }
                        } else if ($("#exampleRadios1").is(":checked")) {
                            dEmail = "Self Drive";
                        }
                        id = $("#carRegisterNumModal2").text()
                        var reserveObj = {
                            bkId: "BK_" + bookingId,
                            bkCusEmail: $("#customerEmailModal2").text(),
                            bkCar: $("#carRegisterNumModal2").text(),
                            bkDate: $("#todayModal2").text(),
                            bkReturnDate: $("#returnDateModal2").text(),
                            bkTotal: $("#totalModal2").text(),
                            bkDriver: dEmail,
                            bkStatus: "Pending",
                            bkAdminStatus: "Unapproved"
                        }
                        $.ajax({
                            url: baseURL + "booking",
                            method: "post",
                            data: JSON.stringify(reserveObj),
                            contentType: "application/json",
                            dataType: "json",
                            success: function (res) {
                                console.log(id);
                                $.ajax({
                                    url: baseURL + "car?id=" + id + "",
                                    dataType: "json",
                                    success: function (resp) {
                                        for (let x of resp.data) {
                                            var carObj = {
                                                registrationNo: x.registrationNo,
                                                carBrand: x.carBrand,
                                                carType: x.carType,
                                                numberOfPassengers: x.numberOfPassengers,
                                                transmissionType: x.transmissionType,
                                                fuelType: x.fuelType,
                                                dailyPrice: x.dailyPrice,
                                                monthlyPrice: x.monthlyPrice,
                                                priceForExtraKM: x.priceForExtraKM,
                                                color: x.color,
                                                available: "Reserved",
                                                status: x.status,
                                            }
                                            $.ajax({
                                                url: baseURL + 'car',
                                                method: 'put',
                                                contentType: "application/json",
                                                data: JSON.stringify(carObj),
                                                dataType: "json",
                                                success: function (res) {
                                                },
                                                error: function (error) {
                                                    let cause = JSON.parse(error.responseText).message;
                                                    alert(cause);
                                                }

                                            });
                                            break;
                                        }
                                        alert(resp.message);
                                    }
                                });
                            },
                            error: function (err) {
                                let message = JSON.parse(err.responseText).message;
                                alert(message);
                                console.log("Error : " + message)
                            }
                        });
                    }
                });
            },
            error: function (err) {
                let message = JSON.parse(err.responseText).message;
                alert(message);
                console.log("Error : " + message)
            }
        });

    });

    $("#returnCarBtn").click(function () {
        let extraKm = $('#extraKmInputField').val();;
        $.ajax({
            url: baseURL + "booking",
            dataType: "json",
            success: function (res) {
                for (let x of res.data) {
                    if (x.bkId === bookingId) {
                        $.ajax({
                            url: baseURL + "car?id=" + x.bkCar + "",
                            dataType: "json",
                            success: function (resp) {
                                for (let y of resp.data) {
                                    if (y.registrationNo === x.bkCar) {

                                        let damageTotal = x.bkTotal + (y.priceForExtraKM * extraKm);

                                        if ($("#damageCheckBox").is(":checked")) {
                                            if (y.carType === "General") {
                                                damageTotal = damageTotal + 10000;
                                            }
                                            if (y.carType === "Premium") {
                                                damageTotal = damageTotal + 15000;
                                            }
                                            if (y.carType === "Luxury") {
                                                damageTotal = damageTotal + 20000;
                                            }

                                        }


                                        var reserveObj = {
                                            bkId: bookingId,
                                            bkCusEmail: x.bkCusEmail,
                                            bkCar: x.bkCar,
                                            bkDate: x.bkDate,
                                            bkReturnDate: x.bkReturnDate,
                                            bkTotal: damageTotal,
                                            bkDriver: x.bkDriver,
                                            bkStatus: "Closed",
                                            bkAdminStatus: x.bkAdminStatus
                                        }
                                        var carObj = {
                                            registrationNo: y.registrationNo,
                                            carBrand: y.carBrand,
                                            carType: y.carType,
                                            numberOfPassengers: y.numberOfPassengers,
                                            transmissionType: y.transmissionType,
                                            fuelType: y.fuelType,
                                            dailyPrice: y.dailyPrice,
                                            monthlyPrice: y.monthlyPrice,
                                            priceForExtraKM: y.priceForExtraKM,
                                            color: y.color,
                                            available: "Available",
                                            status: x.status,
                                        }
                                        $.ajax({
                                            url: baseURL + 'booking',
                                            method: 'put',
                                            contentType: "application/json",
                                            data: JSON.stringify(reserveObj),
                                            dataType: "json",
                                            success: function (res) {
                                                $.ajax({
                                                    url: baseURL + 'car',
                                                    method: 'put',
                                                    contentType: "application/json",
                                                    data: JSON.stringify(carObj),
                                                    dataType: "json",
                                                    success: function (res) {

                                                        if (!(x.bkDriver === "Self Drive")){
                                                            $.ajax({
                                                                url: baseURL + "driver",
                                                                dataType: "json",
                                                                success: function (res) {
                                                                    for (let z of res.data) {
                                                                        if (z.driverEmail === x.bkDriver){
                                                                            var driverObj = {
                                                                                driverEmail: z.driverEmail,
                                                                                driverName: z.driverName,
                                                                                driverAddress: z.driverAddress,
                                                                                driverNICorLicenceNo: z.driverNICorLicenceNo,
                                                                                driverContact: z.driverContact,
                                                                                available: "Available"
                                                                            }
                                                                            $.ajax({
                                                                                url: baseURL + "driver",
                                                                                method: "put",
                                                                                data: JSON.stringify(driverObj),
                                                                                contentType: "application/json",
                                                                                dataType: "json",
                                                                                success: function (res) {
                                                                                    loadUserData();
                                                                                    alert("Vehicle Successfully Returned");
                                                                                }
                                                                            });
                                                                        }

                                                                    }
                                                                }
                                                            });
                                                        }else {
                                                            alert("Vehicle Successfully Returned");
                                                        }
                                                    },
                                                    error: function (error) {
                                                        let cause = JSON.parse(error.responseText).message;
                                                        alert(cause);
                                                    }
                                                });
                                            },
                                            error: function (error) {
                                                let cause = JSON.parse(error.responseText).message;
                                                alert(cause);
                                            }

                                        });
                                    } else {

                                    }
                                }
                            }
                        });
                    } else {

                    }
                }
            }, error: function (err) {
                let message = JSON.parse(err.responseText).message;
                alert(message);
                console.log("Error : " + message)
            }
        });
    });

</script>
</body>
</html>